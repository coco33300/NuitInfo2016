<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Météo</title>

    <style>
        #METEO > img {
            float: left;
        }
        #METEO > div {
            line-height: 50px;
        }
    </style>
</head>
<body>
    <div id="METEO">
    </div>
    <script>
        function init() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showWeather);
            } else {
                x.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showWeather(position) {
            var url = "http://api.openweathermap.org/data/2.5/weather?lat="+position.coords.latitude+
                    "&lon="+position.coords.longitude+"&units=metric&appid=354821bd975ea4ca47de9cdf5591d9e2";
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.send();

            xhr.onreadystatechange = processRequest;

            function processRequest(e) {
                if (xhr.readyState == 4 && xhr.status == 200) {

                    var response = JSON.parse(xhr.responseText);

                    console.log(response);
                    var meteo = document.getElementById("METEO");

                    var h2 = document.createElement("h2");
                    h2.append(document.createTextNode("Météo "+response["name"]));

                    meteo.append(h2);

                    var img = document.createElement("img");
                    img.setAttribute("src", "http://openweathermap.org/img/w/"+response["weather"][0]["icon"]+".png");
                    meteo.append(img);

                    var temp = document.createElement("div");
                    temp.append(document.createTextNode("Température: "+(response["main"]["temp"])+" °C"));

                    meteo.append(temp);

                    img = document.createElement("img");
                    img.setAttribute("src", "vent.png");
                    meteo.append(img);


                    var wind = document.createElement("div");
                    wind.append(document.createTextNode("Vent: "+(response["wind"]["speed"])+" m/s"));

                    meteo.append(wind);
                }
            }
        }
        init();
    </script>
</body>
</html>